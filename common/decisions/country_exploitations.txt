exploit_state = {
    exploit_state_ignore_me = {
        allowed = {
            always = yes
        }
        visible = {
            always = yes
        }
        available = {
            always = no
        }
    }
    exploit_state_release = {
        allowed = {
            always = yes
        }
        target_root_trigger = {
            is_ai = no
        }
        targets_dynamic = yes
        target_trigger = {
            FROM = {
                has_autonomy_state = autonomy_exploited_state
                is_subject_of = ROOT
            }
        }
        complete_effect = {
            set_autonomy = {
                target = FROM
                autonomy_state = autonomy_free
                end_wars = no
            }
        }
    }

    exploit_state_seize_army = { # placeholder till better system
        allowed = {
            always = yes
        }

        visible = {
            is_ai = no
            any_country = {
                is_subject_of = ROOT
                has_autonomy_state = autonomy_exploited_state
            }
        }

        complete_effect = {
            every_possible_country = {
                limit = {
                    is_subject_of = ROOT
                    has_autonomy_state = autonomy_exploited_state
                }
                transfer_units_fraction = {
                    target = ROOT
                    size = 1
                    stockpile_ratio = 1
                    army_ratio = 1
                    air_ratio = 1
                    navy_ratio = 0   
                }
            }
        }
    }

    exploit_state_seize_dockyards = { # placeholder till better system
        allowed = {
            always = yes
        }

        visible = {
            is_ai = no
            any_country = {
                is_subject_of = ROOT
                has_autonomy_state = autonomy_exploited_state
            }
        }

        complete_effect = {
            every_possible_country = {
                limit = {
                    is_subject_of = ROOT
                    has_autonomy_state = autonomy_exploited_state
                }
                hidden_effect = {
                    exploit_seize_dockyards = yes
                    IF = {
                        limit = {
                            num_of_naval_factories > 0
                        }
                        transfer_units_fraction= {
                            target = ROOT
                            size = 0
                            navy_ratio = 1
                        }
                    }
                }
            }
            exploit_dockyard_navy_tooltip = yes
        }
    }

    exploit_state_generic = {
        icon = GFX_decision_SWI_consolidate_council_power

        allowed = {
            always = yes
        }

        target_root_trigger = {
            is_ai = no
        }

        targets_dynamic = yes

        target_trigger = {
            OR = {
                AND = {
                    ROOT = {
                        tag = ENG
                    }
                    FROM = {
                        OR = {
                            tag = CAN
                            tag = SAF
                            tag = AST
                            tag = NZL
                            tag = RAJ
                            tag = FRA
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = FRA
                    }
                    FROM = {
                        OR = {
                            tag = CAN
                            tag = SAF
                            tag = AST
                            tag = NZL
                            tag = RAJ
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = CAN
                    }
                    FROM = {
                        OR = {
                            tag = SAF
                            tag = AST
                            tag = NZL
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = SAF
                    }
                    FROM = {
                        OR = {
                            tag = CAN
                            tag = AST
                            tag = NZL
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = AST
                    }
                    FROM = {
                        OR = {
                            tag = CAN
                            tag = SAF
                            tag = NZL
                            tag = RAJ
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = NZL
                    }
                    FROM = {
                        OR = {
                            tag = CAN
                            tag = SAF
                            tag = AST
                            tag = RAJ
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = RAJ
                    }
                    FROM = {
                        OR = {
                            tag = AST
                            tag = NZL
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = GER
                    }
                    FROM = {
                        OR = {
                            tag = HUN
                            tag = ROM
                            tag = FIN
                            tag = SPR
                            tag = BUL
                            AND = {
                                original_tag = FRA
                                NOT = {
                                    tag = FRA
                                }
                            }
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = HUN
                    }
                    FROM = {
                        OR = {
                            tag = ROM
                            tag = BUL
                            tag = SPR
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = FIN
                    }
                    FROM = {
                        OR = {
                            tag = ROM
                            tag = HUN
                            tag = BUL
                            tag = SPR
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = ROM
                    }
                    FROM = {
                        OR = {
                            tag = HUN
                            tag = BUL
                            tag = SPR
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = SPR
                    }
                    FROM = {
                        OR = {
                            tag = HUN
                            tag = ROM
                            tag = BUL
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = BUL
                    }
                    FROM = {
                        OR = {
                            tag = HUN
                            tag = ROM
                            tag = SPR
                        }
                    }
                }
                AND = {
                    ROOT = {
                        tag = ITA
                    }
                    FROM = {
                        OR = {
                            tag = HUN
                            tag = ROM
                            tag = BUL
                            tag = SPR
                            AND = {
                                original_tag = FRA
                                NOT = {
                                    tag = FRA
                                }
                            }
                        }
                    }
                }
            }
        }

        visible = {
            NOT = {
                FROM = {
                    has_autonomy_state = autonomy_exploited_state
                    is_subject_of = ROOT
                }
            }
        }

        available = {
            AND = {
                FROM = {
                    is_ai = yes
                }
                NOT = {
                    FROM = {
                        has_autonomy_state = autonomy_exploited_state
                    }
                }
                
                IF = {
                    limit = {
                        tag = FRA
                    }
                    AND = {
                        is_in_faction_with = ENG
                        OR = {
                            has_capitulated = yes
                            date > 1941.1.1
                        }
                    }
                }
                
                IF = {
                    limit = {
                        FROM = {
                            tag = FRA
                        }
                    }
                    AND = {
                        OR = {
                            FROM = {
                                has_capitulated = yes
                            }
                            date > 1941.1.1
                        }
                        is_in_faction_with = ENG
                    }
                }

                IF = {
                    limit = {
                        OR = {
                            FROM = {
                                tag = SPR
                            }
                            ROOT = {
                                tag = SPR
                            }
                        }
                    }
                    AND = {
                        SPR = {
                            has_civil_war = no
                        }
                        date > 1938.1.1
                    }
                }

                IF = {
                    limit = {
                        FROM = {
                            tag = FIN
                        }
                    }
                    OR = {
                        NOT = {
                            FROM = {
                                owns_state = 146
                            }
                        }
                        GER = {
                            has_war_with = SOV
                        }
                    }
                }

                IF = {
                    limit = {
                        ROOT = {
                            tag = FIN
                        }
                    }
                    OR = {
                        NOT = {
                            ROOT = {
                                owns_state = 146
                            }
                        }
                        GER = {
                            has_war_with = SOV
                        }
                    }
                }

                IF = {
                    limit = {
                        ROOT = {
                            original_tag = FRA
                            NOT = {
                                tag = FRA
                            }
                        }
                    }
                    ROOT = {
                        OR = {
                            is_in_faction_with = GER
                            has_war_with = ENG
                            has_war_with = FRA
                        }
                    }
                }

                IF = {
                    limit = {
                        FROM = {
                            original_tag = FRA
                            NOT = {
                                tag = FRA
                            }
                        }
                    }
                    FROM = {
                        OR = {
                            is_in_faction_with = GER
                            has_war_with = ENG
                            has_war_with = FRA
                        }
                    }
                }

                IF = {
                    limit = {
                        is_major = yes
                    }
                    OR = {
                        GER = {
                            has_war_with = ENG
                        }
                        date > 1939.6.1
                    }
                }
            }
        }

        complete_effect = {
            set_autonomy = {
                target = FROM
                autonomous_state = autonomy_exploited_state
                end_wars = no
            }
            

            exploit_dockyard_navy_tooltip = yes
            FROM = {
                hidden_effect = {
                    exploit_seize_dockyards = yes
                        transfer_units_fraction = {
                        target = ROOT
                        size = 1
                        stockpile_ratio = 1
                        army_ratio = 1
                        air_ratio = 1
                    }
                    IF = {
                        limit = {
                            num_of_naval_factories > 0
                        }
                        transfer_units_fraction = {
                            target = ROOT
                            size = 0
                            navy_ratio = 1
                        }
                    }
                }
            }
        }
    }
}
